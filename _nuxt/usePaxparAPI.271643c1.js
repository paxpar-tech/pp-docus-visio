import{m as D,ah as E,V as _,l as z}from"./entry.558da846.js";import{u as U}from"./url.635def0a.js";import{u as q}from"./useToast.582151af.js";import{u as G}from"./fetch.c35376f1.js";function f(){return D("backend",()=>{const e=U(),c=z().public.backendForced,r=e.hostname;var s,t;return c!==void 0&&c!==""?(console.log("backendForced",c),s=c,t="forcing via runtine config !!!!"):r==="localhost"?(s="http://localhost:8881",t="hostname is localhost"):d(r,"dev")?(s="https://dev.paxpar.tech",t="hostname contains `.dev.`"):d(r,"uat")?(s="https://uat.paxpar.tech",t="hostname contains `.uat.`"):(s="https://paxpar.tech",t="no other env detected"),console.log(`ðŸ£ useBackend ${s} because ${t}`),s}).value}const N={toast:{pending:{enable:!0,delay:500,duration:3e3},success:{enable:!0,duration:3e3},error:{enable:!0,duration:3e3}}},V=async(a,e)=>{},I=async(a,e)=>{var g,h,m,b,i,k,$,v,P,F,o,C,y,w,x,B,L,S,T,A;const n=await f(),c=await O(),r=q();e=E(N,e,{headers:{...e==null?void 0:e.headers,Authorization:`Bearer ${c}`}});var s=!0,t;(h=(g=e==null?void 0:e.toast)==null?void 0:g.pending)!=null&&h.enable&&setTimeout(()=>{var u,R;s===!0&&(t=r.loading(((R=(u=e==null?void 0:e.toast)==null?void 0:u.pending)==null?void 0:R.msg)||`${a}`))},e.toast.pending.delay);const l=await G(`${n}${a}`,e,"$0fIGPU0xdF");if(s=!1,l.error.value){const u=((b=(m=e==null?void 0:e.toast)==null?void 0:m.error)==null?void 0:b.msg)||`Error (${l.error.value.statusCode}) : ${l.error.value.message}`;(k=(i=e==null?void 0:e.toast)==null?void 0:i.pending)!=null&&k.enable&&t?r.update(t,{render:u,autoClose:($=e==null?void 0:e.toast.error)==null?void 0:$.duration,closeOnClick:!0,closeButton:!0,type:"error",isLoading:!1}):((P=(v=e==null?void 0:e.toast)==null?void 0:v.error)!=null&&P.enable||(o=(F=e==null?void 0:e.toast)==null?void 0:F.pending)!=null&&o.enable)&&r.error(u)}else{const u=((y=(C=e==null?void 0:e.toast)==null?void 0:C.success)==null?void 0:y.msg)||`${a}`;(x=(w=e==null?void 0:e.toast)==null?void 0:w.pending)!=null&&x.enable&&t?r.update(t,{render:u,autoClose:(B=e.toast.success)==null?void 0:B.duration,closeOnClick:!0,closeButton:!0,type:"success",isLoading:!1}):((S=(L=e==null?void 0:e.toast)==null?void 0:L.success)!=null&&S.enable||(A=(T=e==null?void 0:e.toast)==null?void 0:T.pending)!=null&&A.enable)&&r.success(u)}return l};function W(a,e){const c=`${f()}${a}`,r=new URL(c);return r.searchParams.set("Authorization",`Bearer ${e}`),r.toString()}function d(a,e){return a.includes(`.${e}.`)||a.startsWith(`${e}.`)}function j(){return U().hostname}async function O(){var c;const a=await _(),{data:e,error:n}=await a.auth.getSession();return(c=e==null?void 0:e.session)==null?void 0:c.access_token}async function H(){const{data:a}=await I("/api/conf/front/public");return a}const X=()=>({addAuthURL:W,backend:f(),confFrontPublic:H,domain:j(),isDomainEnv:d,useFetchPP:I,useFetchS3:V,getToken:O});export{X as u};
